{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":1},"end":{"line":2,"column":57,"index":58}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../app/integrations/supabase/client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":59},"end":{"line":3,"column":84,"index":143}}],"key":"6GXn7PAkjfLd/4QLcmmI0alLt58=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":144},"end":{"line":4,"column":55,"index":199}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useFavorites = useFavorites;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _appIntegrationsSupabaseClient = require(_dependencyMap[1], \"../app/integrations/supabase/client\");\n  var _tanstackReactQuery = require(_dependencyMap[2], \"@tanstack/react-query\");\n  function useFavorites(userId) {\n    _s();\n    const [favoriteCourtIds, setFavoriteCourtIds] = (0, _react.useState)(new Set());\n    const [loading, setLoading] = (0, _react.useState)(true);\n    const queryClient = (0, _tanstackReactQuery.useQueryClient)();\n\n    // Fetch user's favorite court IDs (batched in one query)\n    const fetchFavorites = (0, _react.useCallback)(async () => {\n      if (!userId || !(0, _appIntegrationsSupabaseClient.isSupabaseConfigured)()) {\n        setLoading(false);\n        return;\n      }\n      console.log('useFavorites: Fetching favorites for user:', userId);\n      try {\n        const {\n          data,\n          error\n        } = await _appIntegrationsSupabaseClient.supabase.from('court_favorites').select('court_id').eq('user_id', userId);\n        if (error) {\n          console.error('useFavorites: Error fetching favorites:', error);\n          setLoading(false);\n          return;\n        }\n        const courtIds = new Set((data || []).map(fav => fav.court_id));\n        console.log('useFavorites: Loaded', courtIds.size, 'favorites');\n        setFavoriteCourtIds(courtIds);\n        setLoading(false);\n      } catch (error) {\n        console.error('useFavorites: Error in fetchFavorites:', error);\n        setLoading(false);\n      }\n    }, [userId]);\n    (0, _react.useEffect)(() => {\n      fetchFavorites();\n    }, [fetchFavorites]);\n\n    // Toggle favorite (optimistic UI)\n    const toggleFavorite = (0, _react.useCallback)(async courtId => {\n      if (!userId || !(0, _appIntegrationsSupabaseClient.isSupabaseConfigured)()) {\n        console.log('useFavorites: Cannot toggle favorite - no user or Supabase not configured');\n        return;\n      }\n      const isFavorited = favoriteCourtIds.has(courtId);\n      console.log('useFavorites: Toggling favorite for court:', courtId, 'Currently favorited:', isFavorited);\n\n      // OPTIMISTIC UI: Update state immediately\n      setFavoriteCourtIds(prev => {\n        const newSet = new Set(prev);\n        if (isFavorited) {\n          newSet.delete(courtId);\n        } else {\n          newSet.add(courtId);\n        }\n        return newSet;\n      });\n      try {\n        if (isFavorited) {\n          // Remove favorite\n          const {\n            error\n          } = await _appIntegrationsSupabaseClient.supabase.from('court_favorites').delete().eq('user_id', userId).eq('court_id', courtId);\n          if (error) {\n            console.error('useFavorites: Error removing favorite:', error);\n            // Revert optimistic update on error\n            setFavoriteCourtIds(prev => {\n              const newSet = new Set(prev);\n              newSet.add(courtId);\n              return newSet;\n            });\n          } else {\n            console.log('useFavorites: Successfully removed favorite');\n            // Invalidate courts query to refresh the list\n            queryClient.invalidateQueries({\n              queryKey: ['courts']\n            });\n          }\n        } else {\n          // Add favorite\n          const {\n            error\n          } = await _appIntegrationsSupabaseClient.supabase.from('court_favorites').insert({\n            user_id: userId,\n            court_id: courtId\n          });\n          if (error) {\n            console.error('useFavorites: Error adding favorite:', error);\n            // Revert optimistic update on error\n            setFavoriteCourtIds(prev => {\n              const newSet = new Set(prev);\n              newSet.delete(courtId);\n              return newSet;\n            });\n          } else {\n            console.log('useFavorites: Successfully added favorite');\n            // Invalidate courts query to refresh the list\n            queryClient.invalidateQueries({\n              queryKey: ['courts']\n            });\n          }\n        }\n      } catch (error) {\n        console.error('useFavorites: Error in toggleFavorite:', error);\n        // Revert optimistic update on error\n        setFavoriteCourtIds(prev => {\n          const newSet = new Set(prev);\n          if (isFavorited) {\n            newSet.add(courtId);\n          } else {\n            newSet.delete(courtId);\n          }\n          return newSet;\n        });\n      }\n    }, [userId, favoriteCourtIds, queryClient]);\n    const isFavorite = (0, _react.useCallback)(courtId => {\n      return favoriteCourtIds.has(courtId);\n    }, [favoriteCourtIds]);\n    return {\n      favoriteCourtIds,\n      loading,\n      toggleFavorite,\n      isFavorite,\n      refetch: fetchFavorites\n    };\n  }\n  _s(useFavorites, \"tD61+2ZlTCH5yn215UJtBp9Ks84=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient];\n  });\n});","lineCount":140,"map":[[8,2,6,0,"exports"],[8,9,6,0],[8,10,6,0,"useFavorites"],[8,22,6,0],[8,25,6,0,"useFavorites"],[8,37,6,0],[9,2,2,0],[9,6,2,0,"_react"],[9,12,2,0],[9,15,2,0,"require"],[9,22,2,0],[9,23,2,0,"_dependencyMap"],[9,37,2,0],[10,2,3,0],[10,6,3,0,"_appIntegrationsSupabaseClient"],[10,36,3,0],[10,39,3,0,"require"],[10,46,3,0],[10,47,3,0,"_dependencyMap"],[10,61,3,0],[11,2,4,0],[11,6,4,0,"_tanstackReactQuery"],[11,25,4,0],[11,28,4,0,"require"],[11,35,4,0],[11,36,4,0,"_dependencyMap"],[11,50,4,0],[12,2,6,7],[12,11,6,16,"useFavorites"],[12,23,6,28,"useFavorites"],[12,24,6,29,"userId"],[12,30,6,55],[12,32,6,57],[13,4,6,57,"_s"],[13,6,6,57],[14,4,7,2],[14,10,7,8],[14,11,7,9,"favoriteCourtIds"],[14,27,7,25],[14,29,7,27,"setFavoriteCourtIds"],[14,48,7,46],[14,49,7,47],[14,52,7,50],[14,56,7,50,"useState"],[14,62,7,58],[14,63,7,58,"useState"],[14,71,7,58],[14,73,7,72],[14,77,7,76,"Set"],[14,80,7,79],[14,81,7,80],[14,82,7,81],[14,83,7,82],[15,4,8,2],[15,10,8,8],[15,11,8,9,"loading"],[15,18,8,16],[15,20,8,18,"setLoading"],[15,30,8,28],[15,31,8,29],[15,34,8,32],[15,38,8,32,"useState"],[15,44,8,40],[15,45,8,40,"useState"],[15,53,8,40],[15,55,8,41],[15,59,8,45],[15,60,8,46],[16,4,9,2],[16,10,9,8,"queryClient"],[16,21,9,19],[16,24,9,22],[16,28,9,22,"useQueryClient"],[16,47,9,36],[16,48,9,36,"useQueryClient"],[16,62,9,36],[16,64,9,37],[16,65,9,38],[18,4,11,2],[19,4,12,2],[19,10,12,8,"fetchFavorites"],[19,24,12,22],[19,27,12,25],[19,31,12,25,"useCallback"],[19,37,12,36],[19,38,12,36,"useCallback"],[19,49,12,36],[19,51,12,37],[19,63,12,49],[20,6,13,4],[20,10,13,8],[20,11,13,9,"userId"],[20,17,13,15],[20,21,13,19],[20,22,13,20],[20,26,13,20,"isSupabaseConfigured"],[20,56,13,40],[20,57,13,40,"isSupabaseConfigured"],[20,77,13,40],[20,79,13,41],[20,80,13,42],[20,82,13,44],[21,8,14,6,"setLoading"],[21,18,14,16],[21,19,14,17],[21,24,14,22],[21,25,14,23],[22,8,15,6],[23,6,16,4],[24,6,18,4,"console"],[24,13,18,11],[24,14,18,12,"log"],[24,17,18,15],[24,18,18,16],[24,62,18,60],[24,64,18,62,"userId"],[24,70,18,68],[24,71,18,69],[25,6,20,4],[25,10,20,8],[26,8,21,6],[26,14,21,12],[27,10,21,14,"data"],[27,14,21,18],[28,10,21,20,"error"],[29,8,21,26],[29,9,21,27],[29,12,21,30],[29,18,21,36,"supabase"],[29,48,21,44],[29,49,21,44,"supabase"],[29,57,21,44],[29,58,22,9,"from"],[29,62,22,13],[29,63,22,14],[29,80,22,31],[29,81,22,32],[29,82,23,9,"select"],[29,88,23,15],[29,89,23,16],[29,99,23,26],[29,100,23,27],[29,101,24,9,"eq"],[29,103,24,11],[29,104,24,12],[29,113,24,21],[29,115,24,23,"userId"],[29,121,24,29],[29,122,24,30],[30,8,26,6],[30,12,26,10,"error"],[30,17,26,15],[30,19,26,17],[31,10,27,8,"console"],[31,17,27,15],[31,18,27,16,"error"],[31,23,27,21],[31,24,27,22],[31,65,27,63],[31,67,27,65,"error"],[31,72,27,70],[31,73,27,71],[32,10,28,8,"setLoading"],[32,20,28,18],[32,21,28,19],[32,26,28,24],[32,27,28,25],[33,10,29,8],[34,8,30,6],[35,8,32,6],[35,14,32,12,"courtIds"],[35,22,32,20],[35,25,32,23],[35,29,32,27,"Set"],[35,32,32,30],[35,33,32,31],[35,34,32,32,"data"],[35,38,32,36],[35,42,32,40],[35,44,32,42],[35,46,32,44,"map"],[35,49,32,47],[35,50,32,48,"fav"],[35,53,32,51],[35,57,32,55,"fav"],[35,60,32,58],[35,61,32,59,"court_id"],[35,69,32,67],[35,70,32,68],[35,71,32,69],[36,8,33,6,"console"],[36,15,33,13],[36,16,33,14,"log"],[36,19,33,17],[36,20,33,18],[36,42,33,40],[36,44,33,42,"courtIds"],[36,52,33,50],[36,53,33,51,"size"],[36,57,33,55],[36,59,33,57],[36,70,33,68],[36,71,33,69],[37,8,34,6,"setFavoriteCourtIds"],[37,27,34,25],[37,28,34,26,"courtIds"],[37,36,34,34],[37,37,34,35],[38,8,35,6,"setLoading"],[38,18,35,16],[38,19,35,17],[38,24,35,22],[38,25,35,23],[39,6,36,4],[39,7,36,5],[39,8,36,6],[39,15,36,13,"error"],[39,20,36,18],[39,22,36,20],[40,8,37,6,"console"],[40,15,37,13],[40,16,37,14,"error"],[40,21,37,19],[40,22,37,20],[40,62,37,60],[40,64,37,62,"error"],[40,69,37,67],[40,70,37,68],[41,8,38,6,"setLoading"],[41,18,38,16],[41,19,38,17],[41,24,38,22],[41,25,38,23],[42,6,39,4],[43,4,40,2],[43,5,40,3],[43,7,40,5],[43,8,40,6,"userId"],[43,14,40,12],[43,15,40,13],[43,16,40,14],[44,4,42,2],[44,8,42,2,"useEffect"],[44,14,42,11],[44,15,42,11,"useEffect"],[44,24,42,11],[44,26,42,12],[44,32,42,18],[45,6,43,4,"fetchFavorites"],[45,20,43,18],[45,21,43,19],[45,22,43,20],[46,4,44,2],[46,5,44,3],[46,7,44,5],[46,8,44,6,"fetchFavorites"],[46,22,44,20],[46,23,44,21],[46,24,44,22],[48,4,46,2],[49,4,47,2],[49,10,47,8,"toggleFavorite"],[49,24,47,22],[49,27,47,25],[49,31,47,25,"useCallback"],[49,37,47,36],[49,38,47,36,"useCallback"],[49,49,47,36],[49,51,47,37],[49,57,47,44,"courtId"],[49,64,47,59],[49,68,47,64],[50,6,48,4],[50,10,48,8],[50,11,48,9,"userId"],[50,17,48,15],[50,21,48,19],[50,22,48,20],[50,26,48,20,"isSupabaseConfigured"],[50,56,48,40],[50,57,48,40,"isSupabaseConfigured"],[50,77,48,40],[50,79,48,41],[50,80,48,42],[50,82,48,44],[51,8,49,6,"console"],[51,15,49,13],[51,16,49,14,"log"],[51,19,49,17],[51,20,49,18],[51,95,49,93],[51,96,49,94],[52,8,50,6],[53,6,51,4],[54,6,53,4],[54,12,53,10,"isFavorited"],[54,23,53,21],[54,26,53,24,"favoriteCourtIds"],[54,42,53,40],[54,43,53,41,"has"],[54,46,53,44],[54,47,53,45,"courtId"],[54,54,53,52],[54,55,53,53],[55,6,54,4,"console"],[55,13,54,11],[55,14,54,12,"log"],[55,17,54,15],[55,18,54,16],[55,62,54,60],[55,64,54,62,"courtId"],[55,71,54,69],[55,73,54,71],[55,95,54,93],[55,97,54,95,"isFavorited"],[55,108,54,106],[55,109,54,107],[57,6,56,4],[58,6,57,4,"setFavoriteCourtIds"],[58,25,57,23],[58,26,57,24,"prev"],[58,30,57,28],[58,34,57,32],[59,8,58,6],[59,14,58,12,"newSet"],[59,20,58,18],[59,23,58,21],[59,27,58,25,"Set"],[59,30,58,28],[59,31,58,29,"prev"],[59,35,58,33],[59,36,58,34],[60,8,59,6],[60,12,59,10,"isFavorited"],[60,23,59,21],[60,25,59,23],[61,10,60,8,"newSet"],[61,16,60,14],[61,17,60,15,"delete"],[61,23,60,21],[61,24,60,22,"courtId"],[61,31,60,29],[61,32,60,30],[62,8,61,6],[62,9,61,7],[62,15,61,13],[63,10,62,8,"newSet"],[63,16,62,14],[63,17,62,15,"add"],[63,20,62,18],[63,21,62,19,"courtId"],[63,28,62,26],[63,29,62,27],[64,8,63,6],[65,8,64,6],[65,15,64,13,"newSet"],[65,21,64,19],[66,6,65,4],[66,7,65,5],[66,8,65,6],[67,6,67,4],[67,10,67,8],[68,8,68,6],[68,12,68,10,"isFavorited"],[68,23,68,21],[68,25,68,23],[69,10,69,8],[70,10,70,8],[70,16,70,14],[71,12,70,16,"error"],[72,10,70,22],[72,11,70,23],[72,14,70,26],[72,20,70,32,"supabase"],[72,50,70,40],[72,51,70,40,"supabase"],[72,59,70,40],[72,60,71,11,"from"],[72,64,71,15],[72,65,71,16],[72,82,71,33],[72,83,71,34],[72,84,72,11,"delete"],[72,90,72,17],[72,91,72,18],[72,92,72,19],[72,93,73,11,"eq"],[72,95,73,13],[72,96,73,14],[72,105,73,23],[72,107,73,25,"userId"],[72,113,73,31],[72,114,73,32],[72,115,74,11,"eq"],[72,117,74,13],[72,118,74,14],[72,128,74,24],[72,130,74,26,"courtId"],[72,137,74,33],[72,138,74,34],[73,10,76,8],[73,14,76,12,"error"],[73,19,76,17],[73,21,76,19],[74,12,77,10,"console"],[74,19,77,17],[74,20,77,18,"error"],[74,25,77,23],[74,26,77,24],[74,66,77,64],[74,68,77,66,"error"],[74,73,77,71],[74,74,77,72],[75,12,78,10],[76,12,79,10,"setFavoriteCourtIds"],[76,31,79,29],[76,32,79,30,"prev"],[76,36,79,34],[76,40,79,38],[77,14,80,12],[77,20,80,18,"newSet"],[77,26,80,24],[77,29,80,27],[77,33,80,31,"Set"],[77,36,80,34],[77,37,80,35,"prev"],[77,41,80,39],[77,42,80,40],[78,14,81,12,"newSet"],[78,20,81,18],[78,21,81,19,"add"],[78,24,81,22],[78,25,81,23,"courtId"],[78,32,81,30],[78,33,81,31],[79,14,82,12],[79,21,82,19,"newSet"],[79,27,82,25],[80,12,83,10],[80,13,83,11],[80,14,83,12],[81,10,84,8],[81,11,84,9],[81,17,84,15],[82,12,85,10,"console"],[82,19,85,17],[82,20,85,18,"log"],[82,23,85,21],[82,24,85,22],[82,69,85,67],[82,70,85,68],[83,12,86,10],[84,12,87,10,"queryClient"],[84,23,87,21],[84,24,87,22,"invalidateQueries"],[84,41,87,39],[84,42,87,40],[85,14,87,42,"queryKey"],[85,22,87,50],[85,24,87,52],[85,25,87,53],[85,33,87,61],[86,12,87,63],[86,13,87,64],[86,14,87,65],[87,10,88,8],[88,8,89,6],[88,9,89,7],[88,15,89,13],[89,10,90,8],[90,10,91,8],[90,16,91,14],[91,12,91,16,"error"],[92,10,91,22],[92,11,91,23],[92,14,91,26],[92,20,91,32,"supabase"],[92,50,91,40],[92,51,91,40,"supabase"],[92,59,91,40],[92,60,92,11,"from"],[92,64,92,15],[92,65,92,16],[92,82,92,33],[92,83,92,34],[92,84,93,11,"insert"],[92,90,93,17],[92,91,93,18],[93,12,94,12,"user_id"],[93,19,94,19],[93,21,94,21,"userId"],[93,27,94,27],[94,12,95,12,"court_id"],[94,20,95,20],[94,22,95,22,"courtId"],[95,10,96,10],[95,11,96,11],[95,12,96,12],[96,10,98,8],[96,14,98,12,"error"],[96,19,98,17],[96,21,98,19],[97,12,99,10,"console"],[97,19,99,17],[97,20,99,18,"error"],[97,25,99,23],[97,26,99,24],[97,64,99,62],[97,66,99,64,"error"],[97,71,99,69],[97,72,99,70],[98,12,100,10],[99,12,101,10,"setFavoriteCourtIds"],[99,31,101,29],[99,32,101,30,"prev"],[99,36,101,34],[99,40,101,38],[100,14,102,12],[100,20,102,18,"newSet"],[100,26,102,24],[100,29,102,27],[100,33,102,31,"Set"],[100,36,102,34],[100,37,102,35,"prev"],[100,41,102,39],[100,42,102,40],[101,14,103,12,"newSet"],[101,20,103,18],[101,21,103,19,"delete"],[101,27,103,25],[101,28,103,26,"courtId"],[101,35,103,33],[101,36,103,34],[102,14,104,12],[102,21,104,19,"newSet"],[102,27,104,25],[103,12,105,10],[103,13,105,11],[103,14,105,12],[104,10,106,8],[104,11,106,9],[104,17,106,15],[105,12,107,10,"console"],[105,19,107,17],[105,20,107,18,"log"],[105,23,107,21],[105,24,107,22],[105,67,107,65],[105,68,107,66],[106,12,108,10],[107,12,109,10,"queryClient"],[107,23,109,21],[107,24,109,22,"invalidateQueries"],[107,41,109,39],[107,42,109,40],[108,14,109,42,"queryKey"],[108,22,109,50],[108,24,109,52],[108,25,109,53],[108,33,109,61],[109,12,109,63],[109,13,109,64],[109,14,109,65],[110,10,110,8],[111,8,111,6],[112,6,112,4],[112,7,112,5],[112,8,112,6],[112,15,112,13,"error"],[112,20,112,18],[112,22,112,20],[113,8,113,6,"console"],[113,15,113,13],[113,16,113,14,"error"],[113,21,113,19],[113,22,113,20],[113,62,113,60],[113,64,113,62,"error"],[113,69,113,67],[113,70,113,68],[114,8,114,6],[115,8,115,6,"setFavoriteCourtIds"],[115,27,115,25],[115,28,115,26,"prev"],[115,32,115,30],[115,36,115,34],[116,10,116,8],[116,16,116,14,"newSet"],[116,22,116,20],[116,25,116,23],[116,29,116,27,"Set"],[116,32,116,30],[116,33,116,31,"prev"],[116,37,116,35],[116,38,116,36],[117,10,117,8],[117,14,117,12,"isFavorited"],[117,25,117,23],[117,27,117,25],[118,12,118,10,"newSet"],[118,18,118,16],[118,19,118,17,"add"],[118,22,118,20],[118,23,118,21,"courtId"],[118,30,118,28],[118,31,118,29],[119,10,119,8],[119,11,119,9],[119,17,119,15],[120,12,120,10,"newSet"],[120,18,120,16],[120,19,120,17,"delete"],[120,25,120,23],[120,26,120,24,"courtId"],[120,33,120,31],[120,34,120,32],[121,10,121,8],[122,10,122,8],[122,17,122,15,"newSet"],[122,23,122,21],[123,8,123,6],[123,9,123,7],[123,10,123,8],[124,6,124,4],[125,4,125,2],[125,5,125,3],[125,7,125,5],[125,8,125,6,"userId"],[125,14,125,12],[125,16,125,14,"favoriteCourtIds"],[125,32,125,30],[125,34,125,32,"queryClient"],[125,45,125,43],[125,46,125,44],[125,47,125,45],[126,4,127,2],[126,10,127,8,"isFavorite"],[126,20,127,18],[126,23,127,21],[126,27,127,21,"useCallback"],[126,33,127,32],[126,34,127,32,"useCallback"],[126,45,127,32],[126,47,127,34,"courtId"],[126,54,127,49],[126,58,127,54],[127,6,128,4],[127,13,128,11,"favoriteCourtIds"],[127,29,128,27],[127,30,128,28,"has"],[127,33,128,31],[127,34,128,32,"courtId"],[127,41,128,39],[127,42,128,40],[128,4,129,2],[128,5,129,3],[128,7,129,5],[128,8,129,6,"favoriteCourtIds"],[128,24,129,22],[128,25,129,23],[128,26,129,24],[129,4,131,2],[129,11,131,9],[130,6,132,4,"favoriteCourtIds"],[130,22,132,20],[131,6,133,4,"loading"],[131,13,133,11],[132,6,134,4,"toggleFavorite"],[132,20,134,18],[133,6,135,4,"isFavorite"],[133,16,135,14],[134,6,136,4,"refetch"],[134,13,136,11],[134,15,136,13,"fetchFavorites"],[135,4,137,2],[135,5,137,3],[136,2,138,0],[137,2,138,1,"_s"],[137,4,138,1],[137,5,6,16,"useFavorites"],[137,17,6,28],[138,4,6,28],[138,12,9,22,"useQueryClient"],[138,31,9,36],[138,32,9,36,"useQueryClient"],[138,46,9,36],[139,2,9,36],[140,0,9,36],[140,3]],"functionMap":{"names":["<global>","useFavorites","fetchFavorites","map$argument_0","useEffect$argument_0","toggleFavorite","setFavoriteCourtIds$argument_0","isFavorite"],"mappings":"AAA;OCK;qCCM;gDCoB,mBD;GDQ;YGE;GHE;qCIG;wBCU;KDQ;8BCc;WDI;8BCkB;WDI;0BCU;ODQ;GJE;iCME;GNE;CDS"},"hasCjsExports":false},"type":"js/module"}]}
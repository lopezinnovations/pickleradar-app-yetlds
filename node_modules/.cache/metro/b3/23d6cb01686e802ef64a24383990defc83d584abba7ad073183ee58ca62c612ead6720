{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.sanitizeURL = sanitizeURL;\n  exports.sanitizeProps = sanitizeProps;\n  /**\n   * URL Security Sanitization\n   *\n   * Protects against XSS via malicious URL protocols in:\n   * - Component props\n   * - Markdown links\n   * - Images\n   *\n   * Uses a strict ALLOWLIST approach - only explicitly allowed protocols pass.\n   * This is more secure than blocklists which can be bypassed.\n   */\n  // ============================================================================\n  // Constants\n  // ============================================================================\n  /**\n   * Protocols that are safe to allow.\n   * Everything else is blocked.\n   */\n  const ALLOWED_PROTOCOLS = new Set(['http:', 'https:', 'mailto:', 'tel:', 'sms:']);\n  // ============================================================================\n  // URL Sanitization\n  // ============================================================================\n  /**\n   * Sanitize a URL by checking against allowed protocols.\n   *\n   * @param url - URL to sanitize\n   * @returns The original URL if safe, null if dangerous\n   *\n   * @example\n   * sanitizeURL('https://example.com')     // 'https://example.com'\n   * sanitizeURL('javascript:alert(1)')     // null\n   * sanitizeURL('/relative/path')          // '/relative/path'\n   * sanitizeURL('data:text/html,...')      // null\n   */\n  function sanitizeURL(url) {\n    if (!url || typeof url !== 'string') {\n      return null;\n    }\n    const trimmed = url.trim();\n    if (trimmed.length === 0) {\n      return null;\n    }\n    // Allow relative URLs - they're safe\n    if (trimmed.startsWith('/') || trimmed.startsWith('#') || trimmed.startsWith('./') || trimmed.startsWith('../')) {\n      return url;\n    }\n    // Parse and check protocol\n    try {\n      const parsed = new URL(trimmed);\n      if (ALLOWED_PROTOCOLS.has(parsed.protocol)) {\n        return url;\n      }\n      // Protocol not in allowlist - block it\n      if (process.env.NODE_ENV !== 'production') {\n        console.warn(`[streamdown-rn] Blocked URL with disallowed protocol: ${parsed.protocol}`);\n      }\n      return null;\n    } catch {\n      // Invalid URL - could be a protocol-relative URL or malformed\n      // Be conservative and block it\n      return null;\n    }\n  }\n  // ============================================================================\n  // Prop Sanitization\n  // ============================================================================\n  /**\n   * Check if a string looks like a URL (has a protocol).\n   * Only strings that look like URLs need sanitization.\n   */\n  function looksLikeURL(value) {\n    // Match strings that start with a protocol-like pattern: word followed by colon\n    return /^[a-z][a-z0-9+.-]*:/i.test(value);\n  }\n  /**\n   * Recursively sanitize component props.\n   *\n   * Checks all string values that look like URLs and sanitizes them.\n   * Preserves all other values unchanged.\n   *\n   * @param props - Props object to sanitize\n   * @returns Sanitized props with dangerous URLs replaced with empty strings\n   *\n   * @example\n   * sanitizeProps({ url: 'javascript:alert(1)', title: 'Safe' })\n   * // { url: '', title: 'Safe' }\n   */\n  function sanitizeProps(props) {\n    const result = {};\n    for (const [key, value] of Object.entries(props)) {\n      if (typeof value === 'string') {\n        // Only check strings that look like URLs\n        if (looksLikeURL(value)) {\n          const safeUrl = sanitizeURL(value);\n          result[key] = safeUrl ?? '';\n        } else {\n          result[key] = value;\n        }\n      } else if (Array.isArray(value)) {\n        // Recursively sanitize arrays\n        result[key] = value.map(item => {\n          if (typeof item === 'object' && item !== null) {\n            return sanitizeProps(item);\n          }\n          if (typeof item === 'string' && looksLikeURL(item)) {\n            return sanitizeURL(item) ?? '';\n          }\n          return item;\n        });\n      } else if (typeof value === 'object' && value !== null) {\n        // Recursively sanitize nested objects\n        result[key] = sanitizeProps(value);\n      } else {\n        // Preserve primitives (numbers, booleans, null)\n        result[key] = value;\n      }\n    }\n    return result;\n  }\n});","lineCount":128,"map":[[7,2,41,0,"exports"],[7,9,41,0],[7,10,41,0,"sanitizeURL"],[7,21,41,0],[7,24,41,0,"sanitizeURL"],[7,35,41,0],[8,2,95,0,"exports"],[8,9,95,0],[8,10,95,0,"sanitizeProps"],[8,23,95,0],[8,26,95,0,"sanitizeProps"],[8,39,95,0],[9,2,1,0],[10,0,2,0],[11,0,3,0],[12,0,4,0],[13,0,5,0],[14,0,6,0],[15,0,7,0],[16,0,8,0],[17,0,9,0],[18,0,10,0],[19,0,11,0],[20,2,12,0],[21,2,13,0],[22,2,14,0],[23,2,15,0],[24,0,16,0],[25,0,17,0],[26,0,18,0],[27,2,19,0],[27,8,19,6,"ALLOWED_PROTOCOLS"],[27,25,19,23],[27,28,19,26],[27,32,19,30,"Set"],[27,35,19,33],[27,36,19,34],[27,37,20,4],[27,44,20,11],[27,46,21,4],[27,54,21,12],[27,56,22,4],[27,65,22,13],[27,67,23,4],[27,73,23,10],[27,75,24,4],[27,81,24,10],[27,82,25,1],[27,83,25,2],[28,2,26,0],[29,2,27,0],[30,2,28,0],[31,2,29,0],[32,0,30,0],[33,0,31,0],[34,0,32,0],[35,0,33,0],[36,0,34,0],[37,0,35,0],[38,0,36,0],[39,0,37,0],[40,0,38,0],[41,0,39,0],[42,0,40,0],[43,2,41,7],[43,11,41,16,"sanitizeURL"],[43,22,41,27,"sanitizeURL"],[43,23,41,28,"url"],[43,26,41,31],[43,28,41,33],[44,4,42,4],[44,8,42,8],[44,9,42,9,"url"],[44,12,42,12],[44,16,42,16],[44,23,42,23,"url"],[44,26,42,26],[44,31,42,31],[44,39,42,39],[44,41,42,41],[45,6,43,8],[45,13,43,15],[45,17,43,19],[46,4,44,4],[47,4,45,4],[47,10,45,10,"trimmed"],[47,17,45,17],[47,20,45,20,"url"],[47,23,45,23],[47,24,45,24,"trim"],[47,28,45,28],[47,29,45,29],[47,30,45,30],[48,4,46,4],[48,8,46,8,"trimmed"],[48,15,46,15],[48,16,46,16,"length"],[48,22,46,22],[48,27,46,27],[48,28,46,28],[48,30,46,30],[49,6,47,8],[49,13,47,15],[49,17,47,19],[50,4,48,4],[51,4,49,4],[52,4,50,4],[52,8,50,8,"trimmed"],[52,15,50,15],[52,16,50,16,"startsWith"],[52,26,50,26],[52,27,50,27],[52,30,50,30],[52,31,50,31],[52,35,50,35,"trimmed"],[52,42,50,42],[52,43,50,43,"startsWith"],[52,53,50,53],[52,54,50,54],[52,57,50,57],[52,58,50,58],[52,62,50,62,"trimmed"],[52,69,50,69],[52,70,50,70,"startsWith"],[52,80,50,80],[52,81,50,81],[52,85,50,85],[52,86,50,86],[52,90,50,90,"trimmed"],[52,97,50,97],[52,98,50,98,"startsWith"],[52,108,50,108],[52,109,50,109],[52,114,50,114],[52,115,50,115],[52,117,50,117],[53,6,51,8],[53,13,51,15,"url"],[53,16,51,18],[54,4,52,4],[55,4,53,4],[56,4,54,4],[56,8,54,8],[57,6,55,8],[57,12,55,14,"parsed"],[57,18,55,20],[57,21,55,23],[57,25,55,27,"URL"],[57,28,55,30],[57,29,55,31,"trimmed"],[57,36,55,38],[57,37,55,39],[58,6,56,8],[58,10,56,12,"ALLOWED_PROTOCOLS"],[58,27,56,29],[58,28,56,30,"has"],[58,31,56,33],[58,32,56,34,"parsed"],[58,38,56,40],[58,39,56,41,"protocol"],[58,47,56,49],[58,48,56,50],[58,50,56,52],[59,8,57,12],[59,15,57,19,"url"],[59,18,57,22],[60,6,58,8],[61,6,59,8],[62,6,60,8],[62,10,60,12,"process"],[62,17,60,19],[62,18,60,20,"env"],[62,21,60,23],[62,22,60,24,"NODE_ENV"],[62,30,60,32],[62,35,60,37],[62,47,60,49],[62,49,60,51],[63,8,61,12,"console"],[63,15,61,19],[63,16,61,20,"warn"],[63,20,61,24],[63,21,61,25],[63,78,61,82,"parsed"],[63,84,61,88],[63,85,61,89,"protocol"],[63,93,61,97],[63,95,61,99],[63,96,61,100],[64,6,62,8],[65,6,63,8],[65,13,63,15],[65,17,63,19],[66,4,64,4],[66,5,64,5],[66,6,65,4],[66,12,65,10],[67,6,66,8],[68,6,67,8],[69,6,68,8],[69,13,68,15],[69,17,68,19],[70,4,69,4],[71,2,70,0],[72,2,71,0],[73,2,72,0],[74,2,73,0],[75,2,74,0],[76,0,75,0],[77,0,76,0],[78,0,77,0],[79,2,78,0],[79,11,78,9,"looksLikeURL"],[79,23,78,21,"looksLikeURL"],[79,24,78,22,"value"],[79,29,78,27],[79,31,78,29],[80,4,79,4],[81,4,80,4],[81,11,80,11],[81,33,80,33],[81,34,80,34,"test"],[81,38,80,38],[81,39,80,39,"value"],[81,44,80,44],[81,45,80,45],[82,2,81,0],[83,2,82,0],[84,0,83,0],[85,0,84,0],[86,0,85,0],[87,0,86,0],[88,0,87,0],[89,0,88,0],[90,0,89,0],[91,0,90,0],[92,0,91,0],[93,0,92,0],[94,0,93,0],[95,0,94,0],[96,2,95,7],[96,11,95,16,"sanitizeProps"],[96,24,95,29,"sanitizeProps"],[96,25,95,30,"props"],[96,30,95,35],[96,32,95,37],[97,4,96,4],[97,10,96,10,"result"],[97,16,96,16],[97,19,96,19],[97,20,96,20],[97,21,96,21],[98,4,97,4],[98,9,97,9],[98,15,97,15],[98,16,97,16,"key"],[98,19,97,19],[98,21,97,21,"value"],[98,26,97,26],[98,27,97,27],[98,31,97,31,"Object"],[98,37,97,37],[98,38,97,38,"entries"],[98,45,97,45],[98,46,97,46,"props"],[98,51,97,51],[98,52,97,52],[98,54,97,54],[99,6,98,8],[99,10,98,12],[99,17,98,19,"value"],[99,22,98,24],[99,27,98,29],[99,35,98,37],[99,37,98,39],[100,8,99,12],[101,8,100,12],[101,12,100,16,"looksLikeURL"],[101,24,100,28],[101,25,100,29,"value"],[101,30,100,34],[101,31,100,35],[101,33,100,37],[102,10,101,16],[102,16,101,22,"safeUrl"],[102,23,101,29],[102,26,101,32,"sanitizeURL"],[102,37,101,43],[102,38,101,44,"value"],[102,43,101,49],[102,44,101,50],[103,10,102,16,"result"],[103,16,102,22],[103,17,102,23,"key"],[103,20,102,26],[103,21,102,27],[103,24,102,30,"safeUrl"],[103,31,102,37],[103,35,102,41],[103,37,102,43],[104,8,103,12],[104,9,103,13],[104,15,104,17],[105,10,105,16,"result"],[105,16,105,22],[105,17,105,23,"key"],[105,20,105,26],[105,21,105,27],[105,24,105,30,"value"],[105,29,105,35],[106,8,106,12],[107,6,107,8],[107,7,107,9],[107,13,108,13],[107,17,108,17,"Array"],[107,22,108,22],[107,23,108,23,"isArray"],[107,30,108,30],[107,31,108,31,"value"],[107,36,108,36],[107,37,108,37],[107,39,108,39],[108,8,109,12],[109,8,110,12,"result"],[109,14,110,18],[109,15,110,19,"key"],[109,18,110,22],[109,19,110,23],[109,22,110,26,"value"],[109,27,110,31],[109,28,110,32,"map"],[109,31,110,35],[109,32,110,36,"item"],[109,36,110,40],[109,40,110,44],[110,10,111,16],[110,14,111,20],[110,21,111,27,"item"],[110,25,111,31],[110,30,111,36],[110,38,111,44],[110,42,111,48,"item"],[110,46,111,52],[110,51,111,57],[110,55,111,61],[110,57,111,63],[111,12,112,20],[111,19,112,27,"sanitizeProps"],[111,32,112,40],[111,33,112,41,"item"],[111,37,112,45],[111,38,112,46],[112,10,113,16],[113,10,114,16],[113,14,114,20],[113,21,114,27,"item"],[113,25,114,31],[113,30,114,36],[113,38,114,44],[113,42,114,48,"looksLikeURL"],[113,54,114,60],[113,55,114,61,"item"],[113,59,114,65],[113,60,114,66],[113,62,114,68],[114,12,115,20],[114,19,115,27,"sanitizeURL"],[114,30,115,38],[114,31,115,39,"item"],[114,35,115,43],[114,36,115,44],[114,40,115,48],[114,42,115,50],[115,10,116,16],[116,10,117,16],[116,17,117,23,"item"],[116,21,117,27],[117,8,118,12],[117,9,118,13],[117,10,118,14],[118,6,119,8],[118,7,119,9],[118,13,120,13],[118,17,120,17],[118,24,120,24,"value"],[118,29,120,29],[118,34,120,34],[118,42,120,42],[118,46,120,46,"value"],[118,51,120,51],[118,56,120,56],[118,60,120,60],[118,62,120,62],[119,8,121,12],[120,8,122,12,"result"],[120,14,122,18],[120,15,122,19,"key"],[120,18,122,22],[120,19,122,23],[120,22,122,26,"sanitizeProps"],[120,35,122,39],[120,36,122,40,"value"],[120,41,122,45],[120,42,122,46],[121,6,123,8],[121,7,123,9],[121,13,124,13],[122,8,125,12],[123,8,126,12,"result"],[123,14,126,18],[123,15,126,19,"key"],[123,18,126,22],[123,19,126,23],[123,22,126,26,"value"],[123,27,126,31],[124,6,127,8],[125,4,128,4],[126,4,129,4],[126,11,129,11,"result"],[126,17,129,17],[127,2,130,0],[128,0,130,1],[128,3]],"functionMap":{"names":["<global>","sanitizeURL","looksLikeURL","sanitizeProps","value.map$argument_0"],"mappings":"AAA;OCwC;CD6B;AEQ;CFG;OGc;oCCe;aDQ;CHY"},"hasCjsExports":false},"type":"js/module"}]}